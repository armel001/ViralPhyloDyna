Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job stats:
job                       count
----------------------  -------
alignment                     1
all                           1
fasta_concatenation           1
initial_tree                  1
mask_alignment                1
metadata_concatenation        1
treetime_ancestral            1
treetime_clock                1
total                         8

Select jobs to execute...
Execute 2 jobs...

[Tue Mar 11 10:03:03 2025]
Job 2: 
        Concatenating query and background FASTA files and removing duplicates
        Samples : alpha
        
Reason: Code has changed since last execution

Activating conda environment: .snakemake/conda/ad7b7445f449c5e91328dad022088973_

[Tue Mar 11 10:03:03 2025]
Job 1: 
        Concatenating query and background metadata files
        Samples : alpha
        
Reason: Code has changed since last execution

[Tue Mar 11 10:03:03 2025]
Finished job 1.
1 of 8 steps (12%) done
[Tue Mar 11 10:03:06 2025]
Finished job 2.
2 of 8 steps (25%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Mar 11 10:03:06 2025]
Job 3: 
        Aligning the concatenated FASTA file
        Sample : alpha
        
Reason: Input files updated by another job: results/fasta_concat/alpha_msa_rmdup.fasta

Activating conda environment: .snakemake/conda/74a7941edda4f0c31f986e6d9a101f4b_
[Tue Mar 11 10:05:08 2025]
Finished job 3.
3 of 8 steps (38%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Mar 11 10:05:08 2025]
Job 4: 
        Masking and trimming the alignment using Gblocks
        
Reason: Input files updated by another job: results/alignment/alpha_aligned.fasta

Activating conda environment: .snakemake/conda/e87063144f01018464a6bca12d029641_
[Tue Mar 11 10:05:14 2025]
Finished job 4.
4 of 8 steps (50%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Mar 11 10:05:14 2025]
Job 5: 
        Building a phylogenetic tree using IQ-TREE
        Sample : alpha
        
Reason: Input files updated by another job: results/alignment/alpha_aligned_trimmed.fasta

Activating conda environment: .snakemake/conda/718e0263b3a024fe2825541352618afa_
[Tue Mar 11 10:06:27 2025]
Finished job 5.
5 of 8 steps (62%) done
Select jobs to execute...
Execute 2 jobs...

[Tue Mar 11 10:06:28 2025]
Job 6: 
        Verifiying molecular clock signal
        Sample : alpha
        
Reason: Missing output files: results/treetime_clock/alpha_tree/root_to_tip_regression.pdf; Input files updated by another job: results/phylogenetic_tree/alpha_tree/alpha_aligned_trimmed.fasta.treefile, results/metadata_concat/alpha_metadata.tsv

Activating conda environment: .snakemake/conda/38bd8cbf87b99d167db693ab77b559e9_

[Tue Mar 11 10:06:28 2025]
Job 7: 
        Inferring ancestral sequences using treetime
        Sample : alpha
        
Reason: Missing output files: results/treetime_ancestral/alpha_tree/timetree.nexus; Input files updated by another job: results/phylogenetic_tree/alpha_tree/alpha_aligned_trimmed.fasta.treefile, results/metadata_concat/alpha_metadata.tsv, results/alignment/alpha_aligned.fasta

Activating conda environment: .snakemake/conda/38bd8cbf87b99d167db693ab77b559e9_
ImproperOutputException in rule treetime_clock in file /Users/armel001/Documents/Workflow_template/workflow/rules/treetime_clock_testing.smk, line 1:
Outputs of incorrect type (directories when expecting files or vice versa). Output directories must be flagged with directory(). for rule treetime_clock:
    output: results/treetime_clock/alpha_tree, results/alpha_final_tree, results/treetime_clock/alpha_tree/root_to_tip_regression.pdf
    wildcards: sample=alpha
    affected files:
        results/alpha_final_tree
Removing output files of failed job treetime_clock since they might be corrupted:
results/treetime_clock/alpha_tree, results/alpha_final_tree, results/treetime_clock/alpha_tree/root_to_tip_regression.pdf
[Tue Mar 11 10:08:28 2025]
Error in rule treetime_ancestral:
    jobid: 7
    input: results/phylogenetic_tree/alpha_tree/alpha_aligned_trimmed.fasta.treefile, results/alignment/alpha_aligned.fasta, results/metadata_concat/alpha_metadata.tsv
    output: results/treetime_ancestral/alpha_tree, results/treetime_ancestral/alpha_tree/timetree.nexus
    log: results/log/alpha_aligned_trimmed_tree_ancestral.log (check log file(s) for error details)
    conda-env: /Users/armel001/Documents/Workflow_template/.snakemake/conda/38bd8cbf87b99d167db693ab77b559e9_
    shell:
        
        treetime --aln results/alignment/alpha_aligned.fasta         --tree results/phylogenetic_tree/alpha_tree/alpha_aligned_trimmed.fasta.treefile           --dates results/metadata_concat/alpha_metadata.tsv             --clock-rate 0.008         --clock-std-dev 0.0035         --outdir results/treetime_ancestral/alpha_tree         --confidence
        && mv results/treetime_ancestral/alpha_tree/timetree.nexus "results/final_tree/alpha_timetree.nexus"
        && echo 'Time scale phylogenetic tree constructed alpha' >> results/log/alpha_aligned_trimmed_tree_ancestral.log
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job treetime_ancestral since they might be corrupted:
results/treetime_ancestral/alpha_tree, results/treetime_ancestral/alpha_tree/timetree.nexus
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-03-11T100258.563512.snakemake.log
WorkflowError:
At least one job did not complete successfully.
